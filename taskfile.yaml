# code generated by retab (devel). DO NOT EDIT.
# join the fight against yaml @ github.com/walteh/retab

# source: ".retab/task.retab"

version: 3
tasks:
    generate:
        cmd: mockery
        generates:
          - ./gen/mockery/*.go
        sources:
          - ./**/*.go

    test:
        cmd: go test ./...

    install-executables:
        cmds:
          - go install ./cmd/go-tmpl-typer

    package-extension:
        dir: code-extension
        cmds:
          - rm -rf node_modules
          - rm -rf out
          - bun install
          - bun run package
          - mv ./retab-*.vsix ~/Downloads
          - open https://marketplace.visualstudio.com/manage/publishers/walteh

    rebuild-extension:
        deps:
          - install-executables
        dir: code-extension
        cmds:
          - rm -rf node_modules
          - rm -rf out
          - bun install
          - bun run build

    download-nvim-lspconfig:
        desc: Download nvim-lspconfig and store it in testdata
        cmds:
          - mkdir -p pkg/lsp/testdata/gen
          - rm -f pkg/lsp/testdata/gen/nvim-lspconfig.tar.gz
          - curl -L https://github.com/neovim/nvim-lspconfig/archive/refs/heads/master.tar.gz -o pkg/lsp/testdata/gen/nvim-lspconfig.tar.gz
          - cd pkg/lsp/testdata/gen && tar xzf nvim-lspconfig.tar.gz
          - rm pkg/lsp/testdata/gen/nvim-lspconfig.tar.gz
        status:
          - test -d pkg/lsp/testdata/gen/nvim-lspconfig-master
